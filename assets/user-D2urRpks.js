import{j as e,F as L,z as se,A as ae,t as V,C as oe,E as K,r as c,h as C,M as p,U as ne,I as le,S as A,J as ie,K as ce,L as de,G as ge,O as ue}from"./index-DGUT-eWs.js";import{C as q}from"./card-BUFTJY8F.js";import{t as b,e as me,B as be,D as he,d as M,F as pe,M as T,u as G,R as B,S as ye,j as xe,i as je,l as ve}from"./role-verifier-D07h47BR.js";const fe="rgb(255, 255, 255)",Se="rgb(0, 0, 0)",we="rgb(204, 204, 204)",Ue="rgb(199, 23, 23)",Ne="rgb(254, 131, 0)",$e="rgb(0, 128, 0)",Ce="0",ke="900",Me="1000",ze="1005",Fe="1030",Pe="1035",Re="1040",_e="1050",Ae="1100",Oe="1200",Ee="1500",Le="950",Te="_container_xmw0h_119",Ge="_addActionGroup_xmw0h_125",Be="_tableGridResponsive_xmw0h_180",Ie="_stretchCard_xmw0h_187",De="_fullRow_xmw0h_196",F={white:fe,black:Se,"light-black":"rgb(34, 34, 34)","translucid-black":"rgba(0, 0, 0, 0.06)","ghost-grey":"rgb(243, 243, 243)","bg-grey":"rgb(237, 237, 237)","note-blue":"rgb(237, 246, 253)","light-grey":"rgb(224, 224, 224)","very-light-grey":"rgb(206, 206, 206)","hover-grey":"rgb(216, 216, 216)",grey:we,"med-grey":"rgb(151, 151, 151)","greyish-brown":"rgb(74, 74, 74)","dark-grey":"rgb(112, 112, 112)","body-grey":"rgb(84, 86, 91)","pinkish-grey":"rgb(204, 204, 204)","inactive-grey":"rgb(187, 187, 187)",red:Ue,"light-red":"rgb(247, 220, 220)","light-orange":"rgb(255, 236, 217)",orange:Ne,"yellow-orange":"rgb(254, 191, 0)","bright-green":"rgb(209, 239, 62)","es-green":"rgb(136, 192, 75)","dark-green":"rgb(78, 108, 46)","strong-green":"rgb(145, 199, 23)","light-grayish-green":"rgb(244, 250, 232)","light-blue":"rgb(116, 193, 255)","light-grayish-blue":"rgb(207, 232, 250)","es-blue":"rgb(15, 138, 231)","med-blue":"#0b68ad","dark-blue":"rgb(11, 93, 155)","light-green-hover":"rgb(173, 212, 132)","mostly-desaturated-dark-blue":"rgb(87, 102, 117)","menu-black":"rgb(51, 51, 51)","pale-green":"rgb(244, 250, 232)","grid-bg-grey":"rgb(247, 247, 246)","royal-blue":"rgb(0, 102, 255)","light-green":"rgb(234, 245, 225)","breakline-gray":"rgb(206, 206, 206)","dark-red":"rgb(139, 0, 0)","dark-orange":"rgb(255, 140, 0)",green:$e,"medium-light-orange":"rgb(203, 105, 0)","dark-moderate-blue":"rgb(75, 73, 172)","dark-grayish-blue":"rgb(163, 164, 165)","very-light-gray":"rgb(227, 227, 227)","very-pale-white-blue":"rgb(245, 247, 255)","card-tale":"rgb(125, 160, 250)","card-dark-blue":"rgb(71, 71, 161)","card-light-blue":"rgb(121, 120, 233)","card-light-danger":"rgb(121, 120, 233)","very-light-gray-mostly-white":"rgb(245, 245, 245)","slightly-desaturated-green":"rgb(171, 210, 129)",zBase:Ce,zBackground:ke,zPopover:Me,zAgentNotes:ze,zPaymentPanelOverlay:Fe,zStoreMessagingDisclaimer:Pe,zModalBackground:Re,zModal:_e,zTooltip:Ae,zSpinner:Oe,zBanner:Ee,zComponentSpinner:Le,"base-font-family":'"Lato", Helvetica, "Lucida Grande", Arial, sans-serif',container:Te,addActionGroup:Ge,"is-active":"_is-active_xmw0h_173",tableGridResponsive:Be,stretchCard:Ie,fullRow:De},Ve="rgb(255, 255, 255)",qe="rgb(0, 0, 0)",He="rgb(204, 204, 204)",We="rgb(199, 23, 23)",Ke="rgb(254, 131, 0)",Je="rgb(0, 128, 0)",Qe="0",Xe="900",Ye="1000",Ze="1005",er="1030",rr="1035",tr="1040",sr="1050",ar="1100",or="1200",nr="1500",lr="950",ir="_tableBody_6k9lv_119",cr="_projectGrid_6k9lv_126",dr="_theadLabel_6k9lv_126",gr="_theadBottom_6k9lv_130",_={white:Ve,black:qe,"light-black":"rgb(34, 34, 34)","translucid-black":"rgba(0, 0, 0, 0.06)","ghost-grey":"rgb(243, 243, 243)","bg-grey":"rgb(237, 237, 237)","note-blue":"rgb(237, 246, 253)","light-grey":"rgb(224, 224, 224)","very-light-grey":"rgb(206, 206, 206)","hover-grey":"rgb(216, 216, 216)",grey:He,"med-grey":"rgb(151, 151, 151)","greyish-brown":"rgb(74, 74, 74)","dark-grey":"rgb(112, 112, 112)","body-grey":"rgb(84, 86, 91)","pinkish-grey":"rgb(204, 204, 204)","inactive-grey":"rgb(187, 187, 187)",red:We,"light-red":"rgb(247, 220, 220)","light-orange":"rgb(255, 236, 217)",orange:Ke,"yellow-orange":"rgb(254, 191, 0)","bright-green":"rgb(209, 239, 62)","es-green":"rgb(136, 192, 75)","dark-green":"rgb(78, 108, 46)","strong-green":"rgb(145, 199, 23)","light-grayish-green":"rgb(244, 250, 232)","light-blue":"rgb(116, 193, 255)","light-grayish-blue":"rgb(207, 232, 250)","es-blue":"rgb(15, 138, 231)","med-blue":"#0b68ad","dark-blue":"rgb(11, 93, 155)","light-green-hover":"rgb(173, 212, 132)","mostly-desaturated-dark-blue":"rgb(87, 102, 117)","menu-black":"rgb(51, 51, 51)","pale-green":"rgb(244, 250, 232)","grid-bg-grey":"rgb(247, 247, 246)","royal-blue":"rgb(0, 102, 255)","light-green":"rgb(234, 245, 225)","breakline-gray":"rgb(206, 206, 206)","dark-red":"rgb(139, 0, 0)","dark-orange":"rgb(255, 140, 0)",green:Je,"medium-light-orange":"rgb(203, 105, 0)","dark-moderate-blue":"rgb(75, 73, 172)","dark-grayish-blue":"rgb(163, 164, 165)","very-light-gray":"rgb(227, 227, 227)","very-pale-white-blue":"rgb(245, 247, 255)","card-tale":"rgb(125, 160, 250)","card-dark-blue":"rgb(71, 71, 161)","card-light-blue":"rgb(121, 120, 233)","card-light-danger":"rgb(121, 120, 233)","very-light-gray-mostly-white":"rgb(245, 245, 245)","slightly-desaturated-green":"rgb(171, 210, 129)",zBase:Qe,zBackground:Xe,zPopover:Ye,zAgentNotes:Ze,zPaymentPanelOverlay:er,zStoreMessagingDisclaimer:rr,zModalBackground:tr,zModal:sr,zTooltip:ar,zSpinner:or,zBanner:nr,zComponentSpinner:lr,"base-font-family":'"Lato", Helvetica, "Lucida Grande", Arial, sans-serif',tableBody:ir,projectGrid:cr,theadLabel:dr,theadBottom:gr},k=({row:r,children:t,handleOnDrawerOpen:s,getKey:l})=>e.jsx("div",{className:b.table,children:e.jsx("div",{className:b.row,children:e.jsx("div",{tabIndex:0,className:b.heading,onClick:()=>{s&&s(r)},"data-qa":`${l(r)}-grid-row`,children:t})})}),ur=({value:r,style:t})=>e.jsx("div",{className:`${b.column}`,style:t,children:e.jsx("div",{className:b.content,children:e.jsx("span",{children:r})})}),mr=({style:r,children:t})=>e.jsx("div",{className:`${b.column}`,style:r,children:e.jsx("div",{className:b.content,children:t})}),br=({canEdit:r,canDelete:t,onEdit:s,onDelete:l})=>e.jsx("div",{className:b.actions,style:{width:100},children:e.jsxs("div",{className:b.actionsInnerContainer,children:[r&&e.jsx(L,{icon:se,style:{padding:"0.125rem"},onClick:s}),t&&e.jsx(L,{icon:ae,style:{padding:"0.125rem"},onClick:l})]})});k.Row=ur;k.CustomRowValue=mr;k.Actions=br;const hr=()=>({pipeRowValueFormatter:r=>V.replacePipeToNewHtmlLine(r).map((t,s)=>e.jsx("div",{style:{display:"flex",flexDirection:"column"},children:e.jsx("span",{children:t})},`${t}-${s}`)),periodRowValueFormatter:r=>V.replacePeriodToNewHtmlLine(r).map((t,s)=>e.jsx("div",{style:{display:"flex",flexDirection:"column"},children:e.jsx("span",{children:t})},`${t}-${s}`)),alertTextColorRowFormatter:(r,t)=>e.jsx("div",{className:b.status,style:{width:"auto"},children:e.jsx("span",{className:`${b[t]}`,children:r})}),customStyleClassRowFormatter:(r,t)=>e.jsx("span",{className:t,children:r})}),pr=()=>{const{pipeRowValueFormatter:r}=hr(),t={pipeFormatter:(l,n)=>{const i=l[n];return["list"].includes(n)?r(`${i}`):""},avatarFormatter:(l,n)=>{const i=l[n];return n==="urlPhoto"?e.jsx(oe,{url:`${i}`,alt:`image of user ${i} ${i}`}):""},rolFormatter:(l,n)=>{const i=l[n];return n==="rol"?e.jsx("span",{children:K(`${i}`)}):""}};return{headers:[{name:"urlPhoto",label:"",style:{minWidth:"150px"},rowFormatter:t.avatarFormatter},{name:"name",label:"Nombre",isSortable:!0,style:{minWidth:"150px"}},{name:"lastName",label:"Apellido",isSortable:!0,style:{minWidth:"150px"}},{name:"rol",label:"Rol",isSortable:!0,style:{minWidth:"150px"},rowFormatter:t.rolFormatter},{name:"list",label:"TecnologÃ­as",isSortable:!0,style:{minWidth:"150px"},rowFormatter:t.pipeFormatter},{name:"area",label:"Area",isSortable:!0,style:{minWidth:"100px"}}],projectGridRowFormatter:(l,n)=>{const i=n==null?void 0:n.filter(u=>u.developers.includes(`${l.name} ${l.lastName}`)),d=i==null?void 0:i.map(u=>u.projectName);return i&&d?r(d.join("|")):""}}},yr="_modalForm_vikxx_1",xr={modalForm:yr},jr="_row_1l204_1",vr="_modalFormFooter_1l204_5",z={row:jr,modalFormFooter:vr},P={name:r=>{const t=[];return r||t.push("Username is required"),r.length>50&&t.push("Username limited to 50 characters"),t},lastName:r=>{const t=[];return r||t.push("Lastname is required"),r.length>50&&t.push("Lastname limited to 50 characters"),t},rol:r=>{const t=[];return r||t.push("Role is required"),t},technologies:r=>{const t=[];return r||t.push("Technologies are required"),t},division:r=>{const t=[];return r||t.push("Division is required"),t}},fr=(r,t)=>{const{name:s,lastName:l,rol:n,area:i}=r,[d,u]=c.useState({}),[h,g]=c.useState(!1);return c.useEffect(()=>{let f=!1;const m={},U=P.name(s),w=P.lastName(l),v=P.rol(n),S=P.technologies(t),x=P.division(i);f||(f=!!U.length||!!w.length||!!v.length||!!S.length||!!x.length),m.name=U,m.lastName=w,m.rol=v,m.technologies=S,m.division=x,u(m),g(f)},[i,t,l,s,n]),[h,d]};var J=(r=>(r.Support="Support",r.Staff="Staff",r.InternalApps="Internal Apps",r.NotAsigned="Not Asigned",r))(J||{});const Sr=r=>{switch(r){case"Soporte":return"Support";case"Staff":return"Staff";case"Fabrica":return"Internal Apps";default:return"Not Asigned"}},wr=r=>{switch(r){case"Support":return"Soporte";case"Staff":return"Staff";case"Internal Apps":return"Fabrica";default:return"Sin Asignar"}},Ur=({userFields:r,tecnologiesFields:t,onUserFormChange:s,onSubmit:l,onClose:n,onTechnologyChange:i})=>{const d=c.useId(),[u,h]=c.useState(!1),[g,f]=c.useState(!1),m=c.useMemo(()=>t==null?void 0:t.join(", "),[t]),U=[...Object.values(me),...Object.values(be),...Object.values(he)],[w,v]=fr(r,m),S=async()=>{f(!0),await l(!w,{userFormFields:{...r,list:m.replaceAll(",","|")}}),x()},x=()=>{n(),f(!1)};return e.jsxs("form",{noValidate:!0,autoComplete:"off",className:z.modalForm,onSubmit:a=>{a.preventDefault()},children:[e.jsx("div",{className:z.row,children:e.jsx(C.Input,{id:`${d}-user-name`,type:"text",label:p.UserModalName,value:r.name,onChange:a=>s("name",a.target.value),errors:v.name,showErrors:g})}),e.jsx("div",{className:z.row,children:e.jsx(C.Input,{id:`${d}-user-lastname`,type:"text",label:p.UserModalLastName,value:r.lastName,onChange:a=>s("lastName",a.target.value),errors:v.lastName,showErrors:g})}),e.jsx("div",{className:z.row,children:e.jsxs(C.Select,{id:`${d}-rol`,type:"text",label:p.UserModalRole,value:r.rol,onChange:a=>s("rol",a.target.value),errors:v.rol,showErrors:g,children:[!r.rol&&e.jsx(C.SelectOption,{value:p.UserModalRolePlaceHolder}),Object.values(ne).map(a=>e.jsx(C.SelectOption,{value:a},a))]})}),e.jsxs("div",{className:z.row,children:[e.jsx("div",{"aria-labelledby":"technology-multiple-checkbox-label",className:M.dropdownLabel,children:p.UserModalTechnology}),e.jsx(pe,{id:`${d}-technology`,open:u,onClose:()=>h(!1),onTogglePopover:()=>h(a=>!a),value:m,errors:v.technologies,showErrors:g,testId:"technology-select",placeholder:p.ProjectModalFormDatabasePlaceholder,label:p.UserModalTechnology,children:e.jsx("div",{className:M.dropdown,role:"combobox","aria-expanded":u,"aria-haspopup":"listbox",id:`${d}-technology-multiple-checkbox`,children:e.jsxs("ul",{className:M.dropdownOptions,children:[e.jsx("li",{className:`${M.dropdownOption} ${M.disabled}`,tabIndex:0,"data-value":p.ProjectModalFormDatabasePlaceholder,role:"option",children:e.jsx("em",{children:p.ProjectModalFormDatabasePlaceholder})}),U.map((a,j)=>e.jsx("li",{tabIndex:-1,role:"option","data-value":a,"aria-selected":m.indexOf(a)>-1,className:`${M.dropdownOption} ${m.indexOf(a)>-1?M.selected:""}`,onClick:()=>i(a),children:a},`${j}-${a}`))]})})})]}),e.jsx("div",{className:z.row,children:e.jsxs(C.Select,{id:`${d}-division`,label:p.UserModalDivision,value:r.area,onChange:a=>s("area",a.target.value),errors:v.division,showErrors:g,children:[!r.area&&e.jsx(C.SelectOption,{value:p.UserModalDivisionPlaceHolder}),Object.values(J).map(a=>e.jsx(C.SelectOption,{value:a},a))]})}),e.jsx("div",{className:z.modalFormFooter,children:e.jsx(T.Footer,{onSubmit:S,onCancel:x,showCancel:!0,cancelText:p.AddProjectModalCancel,submitText:p.AddProjectModalSubmit})})]})},H={id:"",name:"",lastName:"",urlPhoto:"",rol:"",list:"",area:""},Q=r=>({name:W(r.name),lastName:W(r.lastName),urlPhoto:r.urlPhoto,rol:le(r.rol),list:Nr(r.list),area:wr(r.area)}),Nr=r=>r.split("|").map(t=>t.trim()).join("|"),W=r=>r.trim().split(" ").map(s=>`${s.charAt(0).toUpperCase()}${s.slice(1)}`).join(" "),$r=r=>({id:`${r.id}`,name:r.name,lastName:r.lastName,urlPhoto:r.urlPhoto,list:r.list,rol:K(`${r.rol}`),area:Sr(r.area)}),Cr=r=>({...Q(r),id:Number(r.id)}),kr=r=>r.split("|"),X=({open:r,title:t,userId:s,onClose:l,OnSubmit:n})=>{const i=c.useId(),[d,u]=c.useState(H),[h,g]=c.useState([]),[f,m]=c.useState(!1),U=`header-${i}`,w=(x,a)=>{u(j=>({...j,[x]:a}))},v=x=>{if(h.indexOf(x)>-1){const j=h.filter(O=>O!==x);g(j)}else g(j=>[...j,x])},S=()=>{l(),u(H),g([])};return c.useEffect(()=>{s&&(async a=>{m(!0);try{const j=await de(a);u($r(j)),g(kr(j.list))}catch{console.log("loadUserData-Error")}m(!1)})(s)},[s]),e.jsxs(e.Fragment,{children:[e.jsxs(T,{open:r,ariaLabelledBy:U,onClose:S,allowEscape:!0,children:[e.jsx(T.Header,{title:t,onClose:S,showIconCloseText:!1,showCloseButton:!0}),e.jsx("div",{className:xr.modalForm,children:e.jsx(Ur,{userFields:d,onUserFormChange:w,onSubmit:n,onClose:S,tecnologiesFields:h,onTechnologyChange:v})})]}),e.jsx(A,{show:f,text:"...Loading User"})]})},Mr=({open:r,updateGrid:t,onClose:s})=>{const[l,n]=c.useState(!1),i=async(d,u)=>{if(d){n(!0);try{const h=Q(u.userFormFields),g=await ie(h);t(g),s()}catch{console.log("CreateUserModal-Error")}n(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(X,{open:r,title:p.CreateUserModalTitle,onClose:s,OnSubmit:i}),e.jsx(A,{show:l,text:"...Creating User"})]})},zr=({open:r,userId:t,updateGrid:s,onClose:l})=>{const[n,i]=c.useState(!1),d=async(u,h)=>{if(u){i(!0);try{const g=Cr(h.userFormFields),f=await ce(g);s(f),l()}catch{console.log("UpdatedUserModal-Error")}i(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(X,{open:r,title:p.UpdateUserModalTitle,onClose:l,OnSubmit:d,userId:t}),e.jsx(A,{show:n,text:"...Updating User"})]})},Fr=({isCreateUserModalOpen:r,closeCreateUserModal:t})=>{const[s,l]=c.useState(!1),[n,i]=c.useState([]),[d,u]=c.useState("id"),[h,g]=c.useState(!0),[f,m]=c.useState(!1),[U,w]=c.useState(),[v,S]=c.useState(),x=G(B.Administrator),a=G(B.Administrator),{headers:j,projectGridRowFormatter:O}=pr(),E=o=>o===d,Y=o=>{E(o)?g(!h):(u(o),g(!1))},Z=o=>E(o)?b.activeSorter:b.sortable,I=d?ye(n,d,h,d==="name"?ve:void 0):n,R=c.useCallback(async()=>{l(!0);try{const o=await ge();i(o)}catch{console.log("error")}l(!1)},[]),ee=async o=>{try{await ue(o),R()}catch{console.log("removeuser-Error")}},re=o=>{w(o),m(!0)},D=o=>{const y=n.find($=>$.id===o.id);if(!y)return R();const N=n.filter($=>$.id!==y.id);N.push(o),i(N)},te=()=>{w(void 0),m(!1)};return c.useEffect(()=>{R()},[R]),c.useEffect(()=>{(async()=>{try{const y=await je();S(y)}catch{console.log("GetProjects-error")}})()},[]),e.jsxs("div",{className:_.userGrid,children:[e.jsxs("div",{className:b.table,children:[e.jsx("div",{className:`${b.thead} ${_.theadBottom} ${_.theadLabel}`,children:e.jsxs("div",{className:b.tr,children:[j.map(({name:o,label:y,isSortable:N,style:$})=>e.jsxs("div",{className:`${Z(o)}`,style:$,onClick:()=>N?Y(o):void 0,"data-qa":`${o}-sort-button`,children:[e.jsx("span",{children:y}),N&&e.jsx(L,{icon:xe(E(o),!h)})]},o)),e.jsx("div",{style:{minWidth:"150px"},"data-qa":"projects-sort-button",children:e.jsx("span",{children:"Proyectos"})},"projects"),e.jsx("div",{className:b.headingActions,style:{width:100}})]})}),I.length===0&&!s&&e.jsx("div",{className:b.noResultsMessage,children:"No Results Were Found"}),e.jsx("div",{className:_.tableBody,children:I.map(o=>e.jsxs(k,{row:o,getKey:y=>`${y.id}-user`,children:[j.map(({name:y,style:N,rowFormatter:$})=>$?e.jsx(k.CustomRowValue,{style:N,children:$(o,y)},y):e.jsx(k.Row,{value:o[y],style:N},y)),e.jsx(k.Row,{value:O(o,v),style:{minWidth:"150px"}}),e.jsx(k.Actions,{canEdit:a,canDelete:x,onEdit:()=>re(o.id),onDelete:()=>ee(o.id)})]},`${o.id}-grid-row`))})]}),e.jsx(A,{show:s,text:"...Loading Users"}),e.jsx(Mr,{open:r,updateGrid:D,onClose:t}),e.jsx(zr,{userId:U,open:f,updateGrid:D,onClose:te})]})},Or=()=>{const[r,t]=c.useState(!1),s=G(B.CanCreateUser);return c.useEffect(()=>{document.title="OLS user"},[]),e.jsx("div",{className:F.container,children:e.jsx("div",{className:`${F.fullRow} ${F.stretchCard}`,children:e.jsxs(q,{width:"100%",children:[e.jsx(q.Header,{title:p.UserPageTitle}),s&&e.jsx("div",{className:F.addActionGroup,children:e.jsx("button",{type:"submit",onClick:()=>t(!0),children:p.UserPageAddButton})}),e.jsx("div",{className:F.tableGridResponsive,children:e.jsx(Fr,{isCreateUserModalOpen:r,closeCreateUserModal:()=>t(!1)})})]})})})};export{Or as default};
